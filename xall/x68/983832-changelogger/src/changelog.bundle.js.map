{"version":3,"sources":["webpack://changelogger/./node_modules/webextension-polyfill-ts/lib/index.js","webpack://changelogger/external \"browser\"","webpack://changelogger/webpack/bootstrap","webpack://changelogger/webpack/runtime/make namespace object","webpack://changelogger/./src/colorscheme/setColorScheme.ts","webpack://changelogger/./src/pages/popup/changelog.ts"],"names":["exports","browser","module","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","r","Symbol","toStringTag","Object","defineProperty","value","setColorScheme","e","matches","document","documentElement","dataset","theme","settings","getElementById","push","colorScheme","window","matchMedia","addEventListener","async","_a","text","resLocal","changelogs","Array","isArray","length","id","version","icon","name","release_notes","url","frag","createDocumentFragment","item","container","createElement","className","appendChild","src","link","href","innerText","target","changelog","dom","DOMParser","parseFromString","querySelectorAll","raw","decodeURIComponent","startsWith","match","body","firstChild","child","removeChild"],"mappings":"8DAGAA,EAAQC,QAAU,EAAlB,M,QCHAC,EAAOF,QAAUC,UCCbE,EAA2B,GAG/B,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaN,QAGrB,IAAIE,EAASC,EAAyBE,GAAY,CAGjDL,QAAS,IAOV,OAHAQ,EAAoBH,GAAUH,EAAQA,EAAOF,QAASI,GAG/CF,EAAOF,QCpBfI,EAAoBK,EAAKT,IACH,oBAAXU,QAA0BA,OAAOC,aAC1CC,OAAOC,eAAeb,EAASU,OAAOC,YAAa,CAAEG,MAAO,WAE7DF,OAAOC,eAAeb,EAAS,aAAc,CAAEc,OAAO,K,mBCDhD,SAASC,EAAeC,GACvBA,EAAEC,QACFC,SAASC,gBAAgBC,QAAQC,MAAQ,OAGzCH,SAASC,gBAAgBC,QAAQC,MAAQ,QCTjD,EAAQ,KAGR,MAAMC,EAAWJ,SAASK,eAAe,YACnCC,EAAON,SAASK,eAAe,QAC/BE,EAAcC,OAAOC,WAAW,gCAuEtCT,SAASU,iBAAiB,oBAnE1BC,iBACI,IAAIC,EACJ,EAAA7B,QAAA,2BAAmC,CAAE8B,KAAM,KAC3C,MAAMC,QAAiB,EAAA/B,QAAA,oBACvBc,EAAeU,GACf,IAAIQ,EAAa,GACbC,MAAMC,QAAQH,EAASC,cACvBA,EAAaD,EAASC,YAEA,IAAtBA,EAAWG,QACXH,EAAWT,KAAK,CACZa,GAAI,OACJC,QAAS,QACTC,KAAM,EAAAtC,QAAA,eAAuB,qBAC7BuC,KAAM,EAAAvC,QAAA,gBAAwB,wBAC9BwC,cAAe,EAAAxC,QAAA,gBAAwB,mBACvCyC,IAAK,mCAGb,MAAMC,EAAOzB,SAAS0B,yBACtB,IAAK,MAAMC,KAAQZ,EAAY,CAE3B,MAAMa,EAAY5B,SAAS6B,cAAc,OACzCD,EAAUE,UAAY,OACtBL,EAAKM,YAAYH,GAEjB,MAAMN,EAAOtB,SAAS6B,cAAc,QACpCP,EAAKQ,UAAY,OACjBF,EAAUG,YAAYT,GAEtB,MAAMD,EAAOrB,SAAS6B,cAAc,OACpCR,EAAKW,IAAML,EAAKN,KAChBC,EAAKS,YAAYV,GAEjB,MAAMY,EAAOjC,SAAS6B,cAAc,KACpCI,EAAKC,KAAOP,EAAKH,IACjBS,EAAKH,UAAY,OACjBG,EAAKE,UAAYR,EAAKL,KACtBW,EAAKG,OAAS,SACdd,EAAKS,YAAYE,GAEjB,MAAMb,EAAUpB,SAAS6B,cAAc,QACvCT,EAAQU,UAAY,UACpBV,EAAQe,UAAY,KAAKR,EAAKP,UAC9BE,EAAKS,YAAYX,GAEjB,MAAMiB,EAAYrC,SAAS6B,cAAc,cACzCQ,EAAUP,UAAY,YAEtB,MAAMQ,GAAM,IAAIC,WAAYC,gBAAgBb,EAAKJ,cAAe,aAEhE,IAAK,MAAMU,IAAQ,IAAIK,EAAIG,iBAAiB,MAAO,CAC/C,MAAMC,EAAMC,mBAAmBV,EAAKC,MAEhCQ,EAAIE,WAAW,sCACfX,EAAKC,MAA4F,QAAnFtB,EAAK8B,EAAIG,MAAM,sEAAmF,IAAPjC,EAAgBA,EAAK,IAAI,IAI1I,KAAO0B,EAAIQ,KAAKC,YAAY,CACxB,MAAMC,EAAQV,EAAIQ,KAAKG,YAAYX,EAAIQ,KAAKC,YAC5CV,EAAUN,YAAYiB,GAE1BpB,EAAUG,YAAYM,GAE1B/B,EAAKyB,YAAYN,MAGrBlB,EAAYG,iBAAiB,SAAUb,GACvCO,EAASM,iBAAiB,SAAS,IAAM,EAAA3B,QAAA,6B","file":"changelog.bundle.js","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\nexports.browser = require(\"webextension-polyfill\");\n","module.exports = browser;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Sets the colorscheme of tahe page\n * @param e The media query for the colorscheme setting\n */\nexport function setColorScheme(e) {\n    if (e.matches) {\n        document.documentElement.dataset.theme = \"dark\";\n    }\n    else {\n        document.documentElement.dataset.theme = \"light\";\n    }\n}\n","require(\"./changelog.css\");\nimport { browser } from \"webextension-polyfill-ts\";\nimport { setColorScheme } from \"../../colorscheme/setColorScheme\";\nconst settings = document.getElementById(\"settings\");\nconst push = document.getElementById(\"push\");\nconst colorScheme = window.matchMedia(\"(prefers-color-scheme: dark)\");\n/**\n * Place saved changelogs into the page\n */\nasync function main() {\n    var _a;\n    browser.browserAction.setBadgeText({ text: \"\" });\n    const resLocal = await browser.storage.local.get();\n    setColorScheme(colorScheme);\n    let changelogs = [];\n    if (Array.isArray(resLocal.changelogs)) {\n        changelogs = resLocal.changelogs;\n    }\n    if (changelogs.length === 0) {\n        changelogs.push({\n            id: \"none\",\n            version: \"0.0.0\",\n            icon: browser.runtime.getURL(\"icons/icon-96.png\"),\n            name: browser.i18n.getMessage(\"noChangelogsYetTitle\"),\n            release_notes: browser.i18n.getMessage(\"noChangelogsYet\"),\n            url: \"https://addons.thunderbird.net\"\n        });\n    }\n    const frag = document.createDocumentFragment();\n    for (const item of changelogs) {\n        // container for changelog item\n        const container = document.createElement(\"div\");\n        container.className = \"item\";\n        frag.appendChild(container);\n        // container for name, icon, version\n        const name = document.createElement(\"span\");\n        name.className = \"name\";\n        container.appendChild(name);\n        // image\n        const icon = document.createElement(\"img\");\n        icon.src = item.icon;\n        name.appendChild(icon);\n        // name and link to AMO\n        const link = document.createElement(\"a\");\n        link.href = item.url;\n        link.className = \"link\";\n        link.innerText = item.name;\n        link.target = \"_blank\";\n        name.appendChild(link);\n        // version\n        const version = document.createElement(\"span\");\n        version.className = \"version\";\n        version.innerText = `- ${item.version}`;\n        name.appendChild(version);\n        // container for changelog\n        const changelog = document.createElement(\"blockquote\");\n        changelog.className = \"changelog\";\n        // use dom parser to remove redirects from links\n        const dom = new DOMParser().parseFromString(item.release_notes, \"text/html\");\n        // loop through each link element\n        for (const link of [...dom.querySelectorAll(\"a\")]) {\n            const raw = decodeURIComponent(link.href);\n            // remove redirect from link if its found\n            if (raw.startsWith(\"https://outgoing.prod.mozaws.net\")) {\n                link.href = ((_a = raw.match(/https?:\\/\\/outgoing\\.prod\\.mozaws\\.net\\/.*\\/(https?:\\/\\/.*)/)) !== null && _a !== void 0 ? _a : [])[1];\n            }\n        }\n        // Move each item from dom to actual document\n        while (dom.body.firstChild) {\n            const child = dom.body.removeChild(dom.body.firstChild);\n            changelog.appendChild(child);\n        }\n        container.appendChild(changelog);\n    }\n    push.appendChild(frag);\n}\ndocument.addEventListener(\"DOMContentLoaded\", main);\ncolorScheme.addEventListener(\"change\", setColorScheme);\nsettings.addEventListener(\"click\", () => browser.runtime.openOptionsPage());\n"],"sourceRoot":""}